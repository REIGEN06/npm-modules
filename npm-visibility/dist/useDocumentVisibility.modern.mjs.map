{"version":3,"file":"useDocumentVisibility.modern.mjs","sources":["../src/useDocumentVisibility.ts"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\r\n\r\ntype Callback = (isVisible: boolean) => void;\r\n\r\ninterface HookTypes {\r\n  count: number;\r\n  visible: boolean;\r\n  onVisibilityChange: (callback: Callback) => void;\r\n}\r\n\r\nexport const useDocumentVisibility = (): HookTypes => {\r\n  const [count, setCount] = useState(0);\r\n  const [visible, setVisible] = useState(true);\r\n  const onVisibilityCallback = useRef<Callback[]>([]);\r\n\r\n  const increment = () => setCount((currentCount) => currentCount + 1);\r\n\r\n  const onVisibilityChange = (callback: Callback) => {\r\n    onVisibilityCallback.current.push(callback);\r\n  };\r\n\r\n  const DocumentVisibilityHandle = (): void => {\r\n    setVisible(document.visibilityState === \"visible\");\r\n    if (document.hidden) {\r\n      increment();\r\n    }\r\n    onVisibilityCallback.current.forEach((callback) =>\r\n      callback(document.visibilityState === \"visible\")\r\n    );\r\n  };\r\n\r\n  useEffect(() => {\r\n    document.addEventListener(\"visibilitychange\", DocumentVisibilityHandle);\r\n    return () => {\r\n      document.removeEventListener(\r\n        \"visibilitychange\",\r\n        DocumentVisibilityHandle\r\n      );\r\n    };\r\n  }, []);\r\n\r\n  return { count, visible, onVisibilityChange };\r\n};\r\n"],"names":["useDocumentVisibility","count","setCount","useState","visible","setVisible","onVisibilityCallback","useRef","DocumentVisibilityHandle","document","visibilityState","hidden","currentCount","current","forEach","callback","useEffect","addEventListener","removeEventListener","onVisibilityChange","push"],"mappings":"4DAUa,MAAAA,EAAwBA,KACnC,MAAOC,EAAOC,GAAYC,EAAS,IAC5BC,EAASC,GAAcF,GAAS,GACjCG,EAAuBC,EAAmB,IAQ1CC,EAA2BA,KAC/BH,EAAwC,YAA7BI,SAASC,iBAChBD,SAASE,QARST,EAAUU,GAAiBA,EAAe,GAWhEN,EAAqBO,QAAQC,QAASC,GACpCA,EAAsC,YAA7BN,SAASC,iBAEtB,EAYA,OAVAM,EAAU,KACRP,SAASQ,iBAAiB,mBAAoBT,GACvC,KACLC,SAASS,oBACP,mBACAV,EAAwB,GAG3B,IAEI,CAAEP,QAAOG,UAASe,mBAxBGJ,IAC1BT,EAAqBO,QAAQO,KAAKL,EACpC"}